<p>Hello guys! I played <a href="https://play.picoctf.org/events/72" target="_blank">picoCTF 2023</a> competition (“picoCTF 2023” or the “Competition”) organized by Carnegie Mellon University (“CMU”). I scored 3000+ points in this CTF. These are the challenges i solved during the CTF.</p>

<ul>
  <li>
    <h3 id="general-skills">General Skills</h3>
    <ul>
      <li>chrono</li>
      <li>money-ware</li>
      <li>permissions</li>
      <li>repitiotions</li>
      <li>useless</li>
      <li>special</li>
      <li>specialer</li>
    </ul>
  </li>
  <li>
    <h3 id="forensics">Forensics</h3>
    <ul>
      <li>hideme</li>
      <li>PcapPoisoning</li>
      <li>who is it</li>
      <li>FindAndOpen</li>
      <li>MSB</li>
    </ul>
  </li>
  <li>
    <h3 id="reverse-engineering">Reverse Engineering</h3>
    <ul>
      <li>Ready Gladiator 0</li>
      <li>Reverse</li>
      <li>Safe Opener 2</li>
      <li>timer</li>
    </ul>
  </li>
  <li>
    <h3 id="web-exploitation">Web Exploitation</h3>
    <ul>
      <li>FindMe</li>
      <li>MatchTheRegex</li>
      <li>SOAP</li>
      <li>More SQLi</li>
    </ul>
  </li>
  <li>
    <h3 id="cryptography">Cryptography</h3>
    <ul>
      <li>HideToSee</li>
      <li>ReadMyCert</li>
      <li>Rotation</li>
      <li>SRA</li>
    </ul>
  </li>
  <li>
    <h3 id="binary-exploitation">Binary Exploitation</h3>
    <ul>
      <li>two-sum</li>
      <li>VNE</li>
    </ul>
  </li>
</ul>

<p>Most of these are basic challenges, so I would like to explain few challenges which are interested me.</p>

<h1 id="special">Special</h1>

<p><img src="/assets/img/post_img/pico23_special.png" alt="Special" /></p>

<p>As suggested i used ssh to login to the special machine. And i tried some commands there but those are spell checked by the machine and it results an error to execute the commands. I tries piping technique together with cat command to find the flag location and print out.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Special$ ls
Is 
sh: 1: Is: not found
Special$ cat *
Cat * 
sh: 1: Cat: not found
Special$ cat | cat *
Cat | cat * 
sh: 1: Cat: not found
cat: blargh: Is a directory
Special$ cat | cat blargh/*
Cat | cat blargh/* 
sh: 1: Cat: not found
picoCTF{5p311ch3ck_15_7h3_w0r57_6a2763f6}
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : picoCTF{5p311ch3ck_15_7h3_w0r57_6a2763f6}</code></p>
</blockquote>

<hr />

<h1 id="specialer">Specialer</h1>

<p><img src="/assets/img/post_img/pico23_specialer.png" alt="Special" /></p>

<p>It is similar to the special challenge. Logged into challenge machine and tried few commands to execute.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ctf-player@saturn.picoctf.net's password: 
Specialer$ ls
-bash: ls: command not found
Specialer$ echo *
abra ala sim
Specialer$ echo abra/*     
abra/cadabra.txt abra/cadaniel.txt
Specialer$ echo ala/*
ala/kazam.txt ala/mode.txt
Specialer$ echo sim/*
sim/city.txt sim/salabim.txt
Specialer$ 
</code></pre></div></div>

<p>Using echo I discovered the files present in the machine. Tried to read abra/cadabra.txt with echo. It is not the flag, and the flag is present in the ala/kazam.txt.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Specialer$ echo "$(&lt;abra/cadabra.txt)"
Nothing up my sleeve!
Specialer$ echo "$(&lt;ala/kazam.txt)"
return 0 picoCTF{y0u_d0n7_4ppr3c1473_wh47_w3r3_d01ng_h3r3_38f5cc78}
Specialer$ 
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : picoCTF{y0u_d0n7_4ppr3c1473_wh47_w3r3_d01ng_h3r3_38f5cc78}</code></p>
</blockquote>

<hr />

<h1 id="two-sum">two-sum</h1>

<p><img src="/assets/img/post_img/pico23_twosum.png" alt="two-sum" /></p>

<p>The source code of the challenge:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">addIntOvf</span><span class="p">(</span><span class="kt">int</span> <span class="n">result</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">,</span> <span class="n">sum</span><span class="p">;</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">flag</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"n1 &gt; n1 + n2 OR n2 &gt; n1 + n2 </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"What two positive numbers can make this possible: </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num2</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"You entered %d and %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">);</span>
        <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
        <span class="n">sum</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">addIntOvf</span><span class="p">(</span><span class="n">sum</span><span class="p">,</span> <span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"No overflow</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
            <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">addIntOvf</span><span class="p">(</span><span class="n">sum</span><span class="p">,</span> <span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"You have an integer overflow</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
            <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">num1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">num2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span><span class="s">"r"</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"flag not found: please run this on the server</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">60</span><span class="p">];</span>
            <span class="n">fgets</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"YOUR FLAG IS: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
            <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We have to input <code class="language-plaintext highlighter-rouge">n1 and n2</code>  those satisfies <code class="language-plaintext highlighter-rouge">n1 &gt; n1 + n2 OR n2 &gt; n1 + n2</code>. Mathematically this is not possible. But in computer memory its possible.</p>

<p>This can be done with simple integer overflow.</p>

<p>The <code class="language-plaintext highlighter-rouge">n1</code> and <code class="language-plaintext highlighter-rouge">n2</code> are declared as signed integers.</p>

<p>Signed int range for</p>

<p>2 bytes(-32,768 to 32,767)
 4 bytes(-2,147,483,648 to 2,147,483,647)</p>

<p>If we store <code class="language-plaintext highlighter-rouge">2,147,483,648</code> in a signed 4 byte integer it will become <code class="language-plaintext highlighter-rouge">-2,147,483,648</code>.</p>

<p>Take <code class="language-plaintext highlighter-rouge">n1 = 2,147,483,648</code> <code class="language-plaintext highlighter-rouge">n2 = 2,147,483,649</code></p>

<p>Here <code class="language-plaintext highlighter-rouge">n1</code> becomes <code class="language-plaintext highlighter-rouge">-2,147,483,648</code> <code class="language-plaintext highlighter-rouge">n2</code> becomes <code class="language-plaintext highlighter-rouge">-2,147,483,647</code></p>

<p>Therefore, <code class="language-plaintext highlighter-rouge">n1 + n2 = -2,147,483,648 + (-2,147,483,647)</code></p>

<p><img src="/assets/img/post_img/pico23_twosum1.png" alt="two-sum" /></p>

<p>But here, <code class="language-plaintext highlighter-rouge">n1&gt;0 and n2&gt;0</code> not satisfied. We only get the flag if it does.</p>

<p>So, we can select two numbers whose sum is  <code class="language-plaintext highlighter-rouge">2147483648.</code> Then the result will be <code class="language-plaintext highlighter-rouge">-2147483648</code>.</p>

<p>Take <code class="language-plaintext highlighter-rouge">n1 = 2147483640 and n2 = 8</code></p>

<p>Then <code class="language-plaintext highlighter-rouge">n1 + n2 = 2147483648</code> , it will be stored as <code class="language-plaintext highlighter-rouge">-2147483648</code></p>

<p><img src="/assets/img/post_img/pico23_twosum2.png" alt="two-sum" /></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : picoCTF{Tw0_Sum_Integer_Bu773R_0v3rfl0w_fe14e9e9}</code></p>
</blockquote>

<hr />

<p>For all the solved challenges <a href="/assets/files/picoctf2023.pdf">click here</a></p>

<hr />
