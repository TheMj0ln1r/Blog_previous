<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Jekyll">

  <title>Mj0ln1r-JerseyCTF 2023</title>
  <link rel="icon" type="image/x-icon" href="assets/img/favicons/favicon.ico">
  <link rel="stylesheet" href="/css/main.css">

  <!-- <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>JerseyCTF 2023 | Mj0ln1’s Blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="JerseyCTF 2023" />
<meta name="author" content="Mj0ln1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hello ctfian’s! I played JerseyCTF 2023 which was happened from 15 Apr to 16 Apr. I played it with the team Invaders0x1. This time I scored 2600+ points. And our Team secured 125th place in CTF." />
<meta property="og:description" content="Hello ctfian’s! I played JerseyCTF 2023 which was happened from 15 Apr to 16 Apr. I played it with the team Invaders0x1. This time I scored 2600+ points. And our Team secured 125th place in CTF." />
<link rel="canonical" href="http://localhost:8000/posts/jerseyctf23" />
<meta property="og:url" content="http://localhost:8000/posts/jerseyctf23" />
<meta property="og:site_name" content="Mj0ln1’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-18T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="JerseyCTF 2023" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mj0ln1","url":"https://themj0ln1r.github.io"},"dateModified":"2023-04-18T00:00:00+05:30","datePublished":"2023-04-18T00:00:00+05:30","description":"Hello ctfian’s! I played JerseyCTF 2023 which was happened from 15 Apr to 16 Apr. I played it with the team Invaders0x1. This time I scored 2600+ points. And our Team secured 125th place in CTF.","headline":"JerseyCTF 2023","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:8000/posts/jerseyctf23"},"url":"http://localhost:8000/posts/jerseyctf23"}</script>
<!-- End Jekyll SEO tag -->
 
</head>

<body>
  <div id="wrapper">
    <header>
  <div class="head-parent">
      <a href="/">
        <h1>mj0ln1r@home:~$</h1></a>
        <span id="command">cat JerseyCTF</span>
    <div class="header-links">
      <a href="/archive"><h2 class="header-link">Archive</h2></a>
<a href="/about"><h2 class="header-link">About</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <article>
  <h2>JerseyCTF 2023</h2>
  <time datetime="2023-04-18T00:00:00+05:30" class="by-line">18 Apr 2023</time>
  <p>Hello ctfian’s! I played <a href="https://ctftime.org/event/1908" target="_blank">JerseyCTF 2023</a> which was happened from  15 Apr to 16 Apr. I played it with the team <a href="https://ctftime.org/team/217079">Invaders0x1</a>.
This time I scored 2600+ points. And our Team secured 125th place in CTF.</p>

<p><img src="/assets/img/post_img/jersey_progress.png" alt="Progess" /></p>

<blockquote>
  <p><strong>This time I solved 6 challs in crypto which is my fav category.</strong></p>
</blockquote>

<h1 id="crypto-challs">Crypto Challs</h1>

<h1 id="missing-employee-1">missing employee-1</h1>

<p><img src="/assets/img/post_img/jersey_missemp1.png" alt="missingemp1" /></p>

<p><code class="language-plaintext highlighter-rouge">TGltYSBBbHBoYSBLaWxvIEVjaG8gTWlrZSBJbmRpYSBDaGFybGllIEhvdGVsIEluZGlhIEdvbGYgQWxwaGEgTm92ZW1iZXI=</code>
Decoded this text from base64</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~JerseyCTF/crypto/missing_employe_done<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"TGltYSBBbHBoYSBLaWxvIEVjaG8gTWlrZSBJbmRpYSBDaGFybGllIEhvdGVsIEluZGlhIEdvbGYgQWxwaGEgTm92ZW1iZXI="</span> | <span class="nb">base64</span> <span class="nt">-d</span>
Lima Alpha Kilo Echo Mike India Charlie Hotel India Golf Alpha November
</code></pre></div></div>
<p>Submitted this in flag format, but it doesn’t worked for me. The did a quick google search these words. And i found that these are the <a href="https://en.wikipedia.org/wiki/NATO_phonetic_alphabet" target="_blank"><strong>NATO phonetic alphabets</strong></a>. And decoded it by following the representations of this words.</p>

<p>Lima - l<br />Alpha - a<br />Kilo - k<br /> Echo - e<br /> and so on.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag: jctf{lake-michigan}</code></p>
</blockquote>

<h1 id="jack-and-jill">jack-and-jill</h1>

<p><img src="/assets/img/post_img/jersey_jack.png" alt="jackandjill" /></p>

<p>Ciphertext is given : <code class="language-plaintext highlighter-rouge">pgQVJFCohpccuyBSbwxcxpVZCAATRT</code>. A 2x2 matrix is given [[3,9],[4,7]].</p>

<p>By observing the description i found that this is a <code class="language-plaintext highlighter-rouge">hill cipher</code>. I quickly searched for the hill cipher decoder online. I used <a href="https://www.dcode.fr/hill-cipher" target="_blank">this site</a> to decipher the text.</p>

<p><img src="/assets/img/post_img/jersey_jack1.png" alt="jackandjilldecode" /></p>

<p>The deciphered text is <strong><code class="language-plaintext highlighter-rouge">hiTHEREwelcomeTOlinearALGEBRAZ</code></strong></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{hiTHEREwelcomeTOlinearALGEBRAZ}</code></p>
</blockquote>

<h1 id="space-dust">space-dust</h1>

<p><img src="/assets/img/post_img/jersey_spacedust.png" alt="spacedust" /></p>

<p>The challenge have this attachment <a href="/assets/files/jerseyctf23/message_from_tom.txt" download="">message_from_tom.txt </a></p>

<p>First of all, I observed a <code class="language-plaintext highlighter-rouge">==</code> at the end of the content of the file. Immediated I decoded it from base64 and stored in other file. And the file size is a bit suspicious so I observed its hexdump. It contains a PNG header. So, I renamed the image image into decoded.png. Then i opened the image it has the flag in it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/space-dust<span class="nv">$ </span><span class="nb">cat </span>message_from_tom.txt | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;&gt;</span> decoded
mj0ln1r@Linux:~/space-dust<span class="err">$</span>
mj0ln1r@Linux:~/space-dust<span class="nv">$ </span>xxd decode | <span class="nb">head
</span>00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
00000010: 0000 0a00 0000 05a0 0806 0000 0092 001a  ................
00000020: df00 0000 0173 5247 4200 aece 1ce9 0000  .....sRGB.......
00000030: 0004 6741 4d41 0000 b18f 0bfc 6105 0000  ..gAMA......a...
00000040: 0009 7048 5973 0000 0ec3 0000 0ec3 01c7  ..pHYs..........
00000050: 6fa8 6400 00ff a549 4441 5478 5ee4 fd67  o.d....IDATx^..g
00000060: 776c 3b92 a609 1a35 e9d4 fae8 2b43 6556  wl<span class="p">;</span>....5....+CeV
00000070: 5677 4fcf 879e 5933 ffad fe5d d7a8 55d5  VwO...Y3...]..U.
00000080: 5599 1915 1157 9c7b 34b5 763a f5bc cf6b  U....W.<span class="o">{</span>4.v:...k

mj0ln1r@Linux:~/space-dust<span class="nv">$ </span><span class="nb">mv </span>decoded decoded.png
</code></pre></div></div>

<p>The decoded image is <a href="/assets/files/jerseyctf23/decoded.png" download=""> decoded.png </a>.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{th1s_1s_n0t_a_game}</code></p>
</blockquote>

<h1 id="roko-cipher-in-the-console">roko-cipher-in-the-console</h1>

<p><img src="/assets/img/post_img/jersey_roko.png" alt="roko" /></p>

<p>We can see this is a transpositional cipher. <code class="language-plaintext highlighter-rouge">f1stg}th10_ej{s__act_nam</code>. I observed that the flag is plaintext but it was transposed. We can observe that the <code class="language-plaintext highlighter-rouge">jctf{}</code> letters in the ciphertext.</p>

<p>I wrote this ciphertext in different deapths. Like writing it in 4 columns, 5 columns and so on . I observed a standard format when I write this in 6 columns.</p>

<p><img src="/assets/img/post_img/jersey_roko1.png" alt="rokocol" /></p>

<p>We can get the flag by reading column by column and in every column the order of reading letters is row-3,row-4,row-2,row-1.</p>

<p>That is first column should be taken as <code class="language-plaintext highlighter-rouge">jctf</code>. Second column is <code class="language-plaintext highlighter-rouge">{th1</code> and so on.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{th1s_1s_n0t_a_game}</code></p>
</blockquote>

<h1 id="supply-stash">supply-stash</h1>

<p><img src="/assets/img/post_img/jersey_supply1.png" alt="supplystash1" />
<img src="/assets/img/post_img/jersey_supply2.png" alt="supplystash2" /></p>

<p>This is medium level challenge in crypto. The challenge has a java file name <code class="language-plaintext highlighter-rouge">numericalEncoder.java</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Encoding program originally by Logan DesRochers</span>
<span class="kn">import</span> <span class="nn">java.lang.Math</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span> 

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">numericalEncoder</span><span class="o">{</span> 
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span> 
		<span class="nc">String</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyz"</span><span class="o">;</span>
		<span class="nc">Scanner</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span> 
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Enter string to be encoded: "</span><span class="o">);</span>
		<span class="nc">String</span> <span class="n">m</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span> 
		<span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span> 
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Enter int block size: "</span><span class="o">);</span>
		<span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>  

		<span class="c1">//padding to variable block size </span>
		<span class="k">if</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">%</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">){</span> 
			<span class="k">while</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">%</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">){</span> 
				<span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="s">"x"</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"M after padding: "</span> <span class="o">+</span> <span class="n">m</span><span class="o">);</span>
		
		<span class="c1">//Variable block size </span>
		<span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">encodedBlocks</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
		<span class="kt">int</span> <span class="n">numBlocks</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="n">r</span><span class="o">;</span> 
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numBlocks</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span> 
			<span class="nc">String</span> <span class="n">block</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">r</span><span class="o">);</span> 
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">block</span><span class="o">);</span>
			<span class="kt">int</span> <span class="n">power</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
			<span class="kt">int</span> <span class="n">representation</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">block</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">j</span> <span class="o">++){</span>
                        	<span class="nc">String</span> <span class="n">currentLetter</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">j</span><span class="o">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
                        	<span class="kt">int</span> <span class="n">letterValue</span> <span class="o">=</span> <span class="n">alphabet</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">currentLetter</span><span class="o">);</span>
                        	<span class="n">representation</span> <span class="o">+=</span> <span class="n">letterValue</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="mi">26</span><span class="o">,</span> <span class="n">power</span><span class="o">);</span>
                        	<span class="n">power</span><span class="o">--;</span>
                	<span class="o">}</span> 
			<span class="n">encodedBlocks</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">representation</span><span class="o">);</span>
		<span class="o">}</span>
	        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Encoded blocks are as follows: "</span><span class="o">);</span>	
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span> <span class="o">:</span> <span class="n">encodedBlocks</span><span class="o">){</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The output of the above code is <code class="language-plaintext highlighter-rouge">SUPPLIES: 6639182 5837362 7923517 8463981 3588695 8358510"</code> and this is the encoded vesion of our flag. So analyzed the code and reversed the encoding program.</p>

<p>My observations are, the above code is doing generating a integer for for a block of characters. That is <code class="language-plaintext highlighter-rouge">6639182</code> is on encoded version of a block of characters. This is generated by accessing the index of the character from alphabet string and this is multiplied <code class="language-plaintext highlighter-rouge">pow(26,power)</code> where <code class="language-plaintext highlighter-rouge">power=len(block)-1</code> and this power is decreased for every new character in the block.</p>

<p>Okay, lets have some math. lets assume block size = 4 <br />power = 3<br />the initial encoded block value will become<br /> <code class="language-plaintext highlighter-rouge">index(char)x26^3 + index(char)x26^2 + index(char)x26^1 + index(char)x26^0</code><br />
Simply it is doing a <code class="language-plaintext highlighter-rouge">base26</code> operation. So, in the decode program, we have to perform decoding of base26.</p>

<p>This is the solution script which can give the decoded message from encoded blocks.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">string</span>
<span class="n">alphabet</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span>
<span class="n">input_str</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="s">"Enter numerical blocks to be decoded (separated by spaces): "</span><span class="p">)</span>
<span class="c1"># split input into individual numerical blocks
</span><span class="n">input_blocks</span> <span class="o">=</span> <span class="n">input_str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span>
<span class="n">decoded_blocks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">input_blocks</span><span class="p">:</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">while</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">26</span>
        <span class="n">decoded_letter</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">remainder</span><span class="p">]</span>
        <span class="n">decoded</span> <span class="o">=</span> <span class="n">decoded_letter</span> <span class="o">+</span> <span class="n">decoded</span>
        <span class="n">num</span> <span class="o">//=</span> <span class="mi">26</span>
    <span class="n">decoded_blocks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
<span class="c1"># combine decoded blocks into original message
</span><span class="n">decoded_message</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">decoded_blocks</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Decoded message: "</span> <span class="o">+</span> <span class="n">decoded_message</span><span class="p">)</span>
<span class="c1">#6639182 5837362 7923517 8463981 3588695 8358510
# onthemuddyriversnorthwestshore
# jctf{onthemuddyriversnorthwestshore}
</span></code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{onthemuddyriversnorthwestshore}</code></p>
</blockquote>

<h1 id="play-reasonably">play-reasonably</h1>

<p><img src="/assets/img/post_img/jersey_play.png" alt="playreasonably" /></p>

<p>This one is a special challenge. I spent more than an hour to solve this. And at the end of the ctf play-reasonably has only 11 solves.</p>

<p>Okay coming to challenge, I searched many keywords online but I havent find any thing positive. By observing carefully the ciphertext looks like it is from an old cipher. And I know about play-fair cipher. And they said play-reasonably and it matched with it. So, i started deciphering this playfair ciphertext.</p>

<p>Ciphertext : <code class="language-plaintext highlighter-rouge">WTATRHABWKYKACBMWD</code><br />
I tried it with the key <code class="language-plaintext highlighter-rouge">THEBOYSAREBACKINTOWN</code> as the description highlighted it. I solved it with pen and paper as i know the working of playfair. Tried evry possible 5x5 key matrix.</p>

<p><code class="language-plaintext highlighter-rouge">THEBOYSARCKINWDFGLMPQUVXZ (-J)</code><br /><code class="language-plaintext highlighter-rouge">THEBOYSARCKINWDFGJLMPQUXZ (-V)</code><br />
<code class="language-plaintext highlighter-rouge">THEBOYSARCKINWDFGJLMPUVXZ (-Q)</code><br /><code class="language-plaintext highlighter-rouge">THEBOYSARCKINWDFGJLMPQUVX (-Z)</code><br />
None of them are worked. So, I read the description again, They said <code class="language-plaintext highlighter-rouge">theboysarebackintown</code> are playing in reverse.<br /> So, I tried the key matrix in reverse order. <br />
<code class="language-plaintext highlighter-rouge">NWOTIKCABERSYH</code> And the key matrix will be <code class="language-plaintext highlighter-rouge">NWOTIKCABERSYHDFGLMPQUVXZ (-J)</code><br /></p>

<p>And I got the plaintext : <code class="language-plaintext highlighter-rouge">NOBODYCANCRACKTHIS</code><br />
Here is my paper work might help you out.</p>

<p><img src="/assets/img/post_img/jersey_play1.jpeg" alt="playreasonablypaper" /></p>

<p>You can use <a href="https://www.dcode.fr/playfair-cipher" target="_blank">this site</a> to decrypt or learn more about playfair ciper <a href="https://www.geeksforgeeks.org/playfair-cipher-with-examples/" target="_blank">here</a>.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{NOBODYCANCRACKTHIS}</code></p>
</blockquote>

<hr />

<h1 id="web---look-im-hacking">Web - Look-Im-Hacking</h1>

<p><img src="/assets/img/post_img/jersey_lookim.png" alt="look" /></p>

<p>A simple web challenge. The challenge url has the login page. I looked at the source code of it. And found this script.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"text/html"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Document<span class="nt">&lt;/title&gt;</span>

    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
        <span class="kd">var</span> <span class="nx">passkey</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

        <span class="kd">function</span> <span class="nf">createPass</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">valids</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$#@!&amp;%</span><span class="dl">"</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">passkey</span> <span class="o">+=</span> <span class="nx">valids</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">valids</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
            <span class="p">}</span>
            <span class="nx">passkey</span> <span class="o">=</span> <span class="nf">btoa</span><span class="p">(</span><span class="nx">passkey</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nf">checkPass</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">passkey</span><span class="p">)</span>
            <span class="nf">if </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">un1</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pw2</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span> <span class="o">==</span> <span class="nf">atob</span><span class="p">(</span><span class="nx">passkey</span><span class="p">))</span> <span class="p">{</span>
                <span class="nf">loadFlag</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nf">loadFlag</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">xhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
                <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">reveal</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">./flag.txt</span><span class="dl">"</span><span class="p">)</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<p>Found that there is a <code class="language-plaintext highlighter-rouge">/flag.txt</code> end point. And simply curling it results the flag.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/web<span class="nv">$ </span>curl https://www.jerseyctf.online/flag.txt
<span class="nv">$Hacker</span>&amp;?r3@L<span class="err">$</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{$Hacker&amp;?r3@L$}</code></p>
</blockquote>

<hr />

<h1 id="forensics---unknown-origin">Forensics - unknown-origin</h1>

<p><img src="/assets/img/post_img/jersey_unknown.png" alt="unknown" /></p>

<p>The challenge have this attached <a href="/assets/files/jerseyctf23/Photo.jpg" download="">Photo.jpg</a>.</p>

<p>Simple strings does the job.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/forensics<span class="nv">$ </span>strings Photo.jpg | <span class="nb">grep </span>jctf
jctf<span class="o">{</span>0gre<span class="nv">$_h</span>@ve_l@yers<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{0gre$_h@ve_l@yers}</code></p>
</blockquote>

<h1 id="forensics---firefox-history">Forensics - firefox-history</h1>

<p><img src="/assets/img/post_img/jersey_firefox.png" alt="firefox" /></p>

<p>Attached file : <a href="/assets/files/jerseyctf23/places.sqlite" download="">places.sqlite</a></p>

<p>So, i quickly searched for sqlite viewer online (I dont want to install additionally :) )</p>

<p>Found <a href="https://inloop.github.io/sqlite-viewer/" target="_blank">this site</a> to view sqlite file.</p>

<p>As the file name hints places. So selected <code class="language-plaintext highlighter-rouge">moz_places</code> table to view.</p>

<p><img src="/assets/img/post_img/jersey_firefox1.png" alt="firefox places" /></p>

<p>As the description said, i looked for the jerseyctf.com entry in the table. It was on 137th row.</p>

<p><img src="/assets/img/post_img/jersey_firefox2.png" alt="firefox jersey" /></p>

<p>I copied the last time visited value of the 137th entry. As the flag format is <code class="language-plaintext highlighter-rouge">jctf{YYYY-MM-DD-HH-MM-SS}</code> of this time, I used a seconds to epoch converter to get this format.</p>

<p><code class="language-plaintext highlighter-rouge">1674907264007000</code> to epoch on <a href="https://www.epochconverter.com/" target="_blank"> this site </a></p>

<p><img src="/assets/img/post_img/jersey_firefox3.png" alt="firefox epoch" /></p>

<p>And the correct format is the date in GMT that is <code class="language-plaintext highlighter-rouge">2023-01-28-12-01-04</code></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{2023-01-28-12-01-04}</code></p>
</blockquote>

<hr />

<h1 id="bin---plain">bin - plain</h1>

<p><img src="/assets/img/post_img/jersey_plain.png" alt="plain" /></p>

<p>The challenge has bin executable named <code class="language-plaintext highlighter-rouge">plain</code></p>

<p>strings done the job for us again.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/forensics<span class="nv">$ </span>strings plain | <span class="nb">grep </span>jctf
jctf<span class="o">{</span>i_&lt;3_5tr1Ng5_59af0c0ed<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{i_&lt;3_5tr1Ng5_59af0c0ed}</code></p>
</blockquote>

<hr />

<h1 id="osint---record-me">OSINT - record-me</h1>

<p><img src="/assets/img/post_img/jersey_record.png" alt="recordme" /></p>

<p>The challenge is highlighting <code class="language-plaintext highlighter-rouge">record</code> and <code class="language-plaintext highlighter-rouge">jerseyctf.com</code>. So, I search for all the DNS records of jerseyctf.com.</p>

<p>I search all the <code class="language-plaintext highlighter-rouge">whois</code> records of the jerseyctf.com. And in there a string <code class="language-plaintext highlighter-rouge">pw-d714d7aa25df63925ec2b3893928671b</code>. As they are talking about password <code class="language-plaintext highlighter-rouge">pw</code> tempts me to submit it as flag.<br />But afer many unsuccesful tries I tried <code class="language-plaintext highlighter-rouge">dig</code> to fetch <code class="language-plaintext highlighter-rouge">DNS records</code> of jerseyctf.com.</p>

<p>And finally the flag is available at <code class="language-plaintext highlighter-rouge">TXT records</code> of jerseyctf.com. I used <code class="language-plaintext highlighter-rouge">dig</code> to do it.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/osint<span class="nv">$ </span>dig jerseyctf.com txt

<span class="p">;</span> &lt;&lt;<span class="o">&gt;&gt;</span> DiG 9.18.12-0ubuntu0.22.04.1-Ubuntu &lt;&lt;<span class="o">&gt;&gt;</span> jerseyctf.com txt
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="o">&lt;&lt;-</span> <span class="no">opcode</span><span class="sh">: QUERY, status: NOERROR, id: 48664
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;jerseyctf.com.			IN	TXT

;; ANSWER SECTION:
jerseyctf.com.		3600	IN	TXT	"jctf{hop_OFF_TIKTOK_and_GET_s0me_SUN_OUTSID3!}"

;; Query time: 732 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Fri Apr 21 12:14:36 IST 2023
;; MSG SIZE  rcvd: 101
</span></code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{hop_OFF_TIKTOK_and_GET_s0me_SUN_OUTSID3!}</code></p>
</blockquote>

<h1 id="osint---geo-guess">OSINT - geo-guess</h1>

<p><img src="/assets/img/post_img/jersey_geoguess.png" alt="geoguess" /></p>

<p>So, its clear that we have to find the name of the building given in the picture.</p>

<p><img src="/assets/img/post_img/jersey_geoguess1.png" alt="geo" /></p>

<p>I did a quick google image search and found the building name right on the top of result.</p>

<p><img src="/assets/img/post_img/jersey_geoguess2.png" alt="geo" /></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag: jctf{west-edmonton-mall}</code></p>
</blockquote>

<hr />

<h1 id="misc---pits-of-tartarus">Misc - pits-of-tartarus</h1>

<p><img src="/assets/img/post_img/jersey_pits.png" alt="pits" /></p>

<p>The attached file : <a href="/assets/files/jerseyctf23/file834.tar.gz" download="">file834.tar.gz</a></p>

<p>This tar is a hundrends of recompressions of tar.gz</p>

<p>So, I run this command to loop over all the compressions in it and extract the files.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>834..1<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">tar</span> <span class="nt">-xf</span> file<span class="nv">$i</span>.tar.gz<span class="p">;</span> <span class="nb">rm </span>file<span class="nv">$i</span>.tar.gz<span class="p">;</span> <span class="k">done
</span>mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">ls
</span>file0.tar.gz
</code></pre></div></div>
<p>The above command will extract the zips and deletes it prior zip to make directory clean. As we can see now <code class="language-plaintext highlighter-rouge">file0.tar.gz</code> is the last one left.</p>

<p>Again this <code class="language-plaintext highlighter-rouge">file0.tar.gz</code> contains zips from file-1.tar.gz, and so on. So i extracted file0.tar.gz just one time then modified above command lil bit to extract this sequece of tars.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xf</span> file0.tar.gz
mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">ls
</span>file-1.tar.gz
mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..833<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">tar</span> <span class="nt">-xf</span> file-<span class="nv">$i</span>.tar.gz<span class="p">;</span> <span class="nb">rm </span>file-<span class="nv">$i</span>.tar.gz<span class="p">;</span> <span class="k">done
</span><span class="nb">tar</span>: file-390.tar.gz: Cannot open: No such file or directory
<span class="nb">tar</span>: Error is not recoverable: exiting now
mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">ls
</span>file.txt
mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">cat </span>file.txt
jctf<span class="o">{</span>N0t_<span class="nv">$tuck_in_tHe_t</span>@r<span class="o">}</span>
</code></pre></div></div>
<p>I assumed that there will be again 834 zips so I tried the above loop. But actually there were only <code class="language-plaintext highlighter-rouge">389</code> tars. Eventhough the above command extracted the file that we want but returned some error. The flag is present in <code class="language-plaintext highlighter-rouge">file.txt</code></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{N0t_$tuck_in_tHe_t@r}</code></p>
</blockquote>

<hr />

<h1 id="misc---crack-keepass">Misc - crack-keepass</h1>

<p><img src="/assets/img/post_img/jersey_keepass.png" alt="keepass" /></p>

<p>Attached file : <a href="/assets/files/jerseyctf23/Databse.kdbx" download="">Databse.kdbx</a></p>

<p>This time I installed <code class="language-plaintext highlighter-rouge">keepassx</code> on my machine.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/misc<span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nb">install </span>keepassx
</code></pre></div></div>
<p>And I Opened the Database.kdbx with kepassx GUI app. It prompts me for a master password. As the challenge hints that crack, I cracked it with <code class="language-plaintext highlighter-rouge">JOHN</code> and <code class="language-plaintext highlighter-rouge">rockyou.txt</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mj0ln1r@Linux:~/misc<span class="nv">$ </span>keepass2john Database.kdbx <span class="o">&gt;&gt;</span> database_hashes_new.hash
mj0ln1r@Linux:~/misc<span class="nv">$ </span>john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nt">-format</span>:keepass databse_hashes_new.hash
Using default input encoding: UTF-8
		Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>KeePass <span class="o">[</span>SHA256 AES 32/64]<span class="o">)</span>
		Cost 1 <span class="o">(</span>iteration count<span class="o">)</span> is 60000 <span class="k">for </span>all loaded hashes
		Cost 2 <span class="o">(</span>version<span class="o">)</span> is 2 <span class="k">for </span>all loaded hashes
		Cost 3 <span class="o">(</span>algorithm <span class="o">[</span><span class="nv">0</span><span class="o">=</span>AES, <span class="nv">1</span><span class="o">=</span>TwoFish, <span class="nv">2</span><span class="o">=</span>ChaCha]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
		Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
		1jersey          <span class="o">(</span>?<span class="o">)</span>
		1g 0:01:57:04 DONE <span class="o">(</span>2023-04-16 16:24<span class="o">)</span> 0.000142g/s 53.41p/s 53.41c/s 53.41C/s 1jersey
		Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
		Session completed
</code></pre></div></div>
<p>Master key of the database is <code class="language-plaintext highlighter-rouge">1jersey</code>.</p>

<p>So, I opened it the database file with master key. When I am navigating through the database file in keepassx app. I found a file named <code class="language-plaintext highlighter-rouge">flag</code> in General category.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">Flag : jctf{pr073c7_y0ur_v4ul7}</code></p>
</blockquote>

<hr />

</article>
      </section>
    </div>
  </div>

   <footer>
  <a href="/">
    <span>
        <b>Mj0ln1r</b>
    </span>
    
    <span>© 2023
  </a>

  <a href="https://twitter.com/TheMj0ln1r" target="_blank">
  </span>/Twitter</span>
  </a>

  <a href="https://github.com/TheMj0ln1r" target="_blank">
  </span>/Github</span>
  </a>

  <a href="https://www.linkedin.com/in/mj0ln1r" target="_blank">
  </span>/LinkedIn</span></a>

  <a href=""><span style="color:red;">^TOP</span></a>

</footer>

  
</body>

</html>